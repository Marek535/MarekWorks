package pl.kurs.java.pl.kurs.java.controller;


import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import javax.annotation.PostConstruct;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

@RestController
@RequestMapping("/action")
public class ActionController {

    private final Map<String, Operation> operationMap = new HashMap<>();

    @PostConstruct
    public void init() {
        operationMap.put("prime", diviors -> ResponseEntity.ok(diviors.size() == 2));
        operationMap.put("count_divisors", diviors -> ResponseEntity.ok(diviors.size()));
        operationMap.put("get_divisors", diviors -> ResponseEntity.ok(diviors));

    }

    @FunctionalInterface
    interface Operation {
        ResponseEntity result(List diviors);
    }
    //poprawić listę
    

    @GetMapping("/{name}")

    public ResponseEntity getResult(@PathVariable("name") String name, @RequestParam("number") int number) {
        List diviorsList = new ArrayList();
        for (int i = 1; i <= number; i++) {
            if (number % i == 0) {
                diviorsList.add(i);
            }
        }

        return operationMap.get(name).result(diviorsList);

    }
}


//@GET /action/{name}?number=10
//GET /action/PRIME?number=10  ====> false
//GET /action/COUNT_DIVISORS?number=4 =====> 3
//GET /action/GET_DIVISORS?number=4 ====> [1,2,4]

    /*
    ActionController

    @GetMapping ("/action/{name}")
    getResult(@PathVariable("name")String name ,@RequestParam("number") int number)
    //PRIME - zwraca informacje o tym czy dana liczba jest LP
    //COUNT_DIVISOTS - zwraca informacje o ilosci dzielnikow danej liczby
    //GET_DIVISOTS - zwraca liste dzielnikow danej liczby

     */
